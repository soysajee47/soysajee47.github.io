<!DOCTYPE html>
<html lang="th">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡πÅ‡∏™‡∏ô‡∏™‡∏ô‡∏∏‡∏Å üçì</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Kanit', sans-serif;
            background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
            min-height: 100vh;
            overflow-x: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 16px 12px;
        }

        .screen {
            display: none;
            width: 100%;
            max-width: 640px;
            flex-direction: column;
            align-items: center;
            gap: 16px;
        }

        .screen.active {
            display: flex;
        }

        /* LOGO */
        .logo-main {
            font-size: clamp(2rem, 7vw, 3.4rem);
            font-weight: 900;
            background: linear-gradient(135deg, #f093fb 0%, #f5a623 50%, #43e97b 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -1px;
            line-height: 1.1;
        }

        .logo-emoji {
            font-size: 2.8rem;
            display: block;
            margin-bottom: 4px;
            animation: bounce 2s infinite;
        }

        .logo-sub {
            color: rgba(255, 255, 255, .3);
            font-size: .82rem;
            letter-spacing: 1px;
            margin-top: 2px;
        }

        @keyframes bounce {

            0%,
            100% {
                transform: translateY(0)
            }

            50% {
                transform: translateY(-8px)
            }
        }

        /* LOGIN */
        #screen-login {
            padding-top: 28px;
        }

        .login-card {
            background: rgba(255, 255, 255, .07);
            border: 1px solid rgba(255, 255, 255, .13);
            border-radius: 22px;
            padding: 28px 24px;
            width: 100%;
            max-width: 380px;
            text-align: center;
            backdrop-filter: blur(12px);
        }

        .login-label {
            color: rgba(255, 255, 255, .5);
            font-size: .9rem;
            margin-bottom: 10px;
            display: block;
        }

        .name-input {
            width: 100%;
            padding: 14px 18px;
            background: rgba(255, 255, 255, .09);
            border: 2px solid rgba(255, 255, 255, .14);
            border-radius: 13px;
            color: #fff;
            font-family: 'Kanit', sans-serif;
            font-size: 1.1rem;
            font-weight: 600;
            outline: none;
            text-align: center;
            transition: border-color .2s;
        }

        .name-input::placeholder {
            color: rgba(255, 255, 255, .22);
        }

        .name-input:focus {
            border-color: rgba(240, 147, 251, .6);
        }

        .btn-start {
            margin-top: 14px;
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #f093fb, #f5a623);
            border: none;
            border-radius: 13px;
            color: #fff;
            font-family: 'Kanit', sans-serif;
            font-size: 1.05rem;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 8px 22px rgba(240, 147, 251, .35);
            transition: all .2s;
        }

        .btn-start:hover {
            transform: translateY(-2px);
        }

        .btn-start:disabled {
            opacity: .38;
            cursor: not-allowed;
            transform: none;
        }

        /* LEADERBOARD SECTION */
        .lb-wrap {
            width: 100%;
            max-width: 420px;
        }

        .lb-section-title {
            color: rgba(255, 255, 255, .38);
            font-size: .75rem;
            letter-spacing: 1px;
            text-transform: uppercase;
            margin-bottom: 10px;
            text-align: center;
        }

        /* PODIUM TOP3 */
        .podium-row {
            display: grid;
            grid-template-columns: 3fr 3fr 3fr;
            gap: 8px;
            margin-bottom: 10px;
        }

        .podium-card {
            border-radius: 14px;
            padding: 14px 8px;
            text-align: center;
        }

        .podium-card.gold {
            background: linear-gradient(160deg, rgba(255, 215, 0, .22), rgba(255, 165, 0, .1));
            border: 1px solid rgba(255, 215, 0, .4);
        }

        .podium-card.silver {
            background: linear-gradient(160deg, rgba(192, 192, 192, .18), rgba(150, 150, 150, .07));
            border: 1px solid rgba(192, 192, 192, .28);
        }

        .podium-card.bronze {
            background: linear-gradient(160deg, rgba(205, 133, 63, .18), rgba(180, 100, 40, .07));
            border: 1px solid rgba(205, 133, 63, .28);
        }

        .podium-rank {
            font-size: 1.5rem;
            margin-bottom: 4px;
        }

        .podium-name {
            color: #fff;
            font-weight: 700;
            font-size: .82rem;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .podium-time {
            font-weight: 800;
            font-size: 1.05rem;
            margin-top: 3px;
        }

        .podium-card.gold .podium-time {
            color: #f5a623;
        }

        .podium-card.silver .podium-time {
            color: #c0c0c0;
        }

        .podium-card.bronze .podium-time {
            color: #cd853f;
        }

        .podium-stars {
            font-size: .75rem;
            color: rgba(255, 255, 255, .4);
            margin-top: 1px;
        }

        /* REST OF LB */
        .lb-list {
            width: 100%;
        }

        .lb-list-row {
            display: grid;
            grid-template-columns: 32px 1fr 72px 60px;
            gap: 8px;
            align-items: center;
            padding: 9px 12px;
            border-radius: 11px;
            margin-bottom: 5px;
            background: rgba(255, 255, 255, .04);
            border: 1px solid rgba(255, 255, 255, .06);
        }

        .lb-list-row.is-me {
            background: rgba(240, 147, 251, .08);
            border-color: rgba(240, 147, 251, .3);
        }

        .lb-rk {
            color: rgba(255, 255, 255, .4);
            font-size: .8rem;
            font-weight: 700;
            text-align: center;
        }

        .lb-nm {
            color: #fff;
            font-weight: 600;
            font-size: .85rem;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .lb-tm {
            color: #43e97b;
            font-weight: 700;
            font-size: .85rem;
            text-align: right;
        }

        .lb-st {
            font-size: .72rem;
            color: #fbd38d;
            text-align: right;
        }

        .lb-empty {
            color: rgba(255, 255, 255, .2);
            text-align: center;
            padding: 18px;
            font-size: .85rem;
        }

        .see-more-btn {
            background: none;
            border: 1px solid rgba(255, 255, 255, .1);
            border-radius: 50px;
            color: rgba(255, 255, 255, .35);
            font-family: 'Kanit', sans-serif;
            font-size: .78rem;
            padding: 6px 16px;
            cursor: pointer;
            margin-top: 4px;
            transition: all.2s;
        }

        .see-more-btn:hover {
            color: #fff;
            border-color: rgba(255, 255, 255, .3);
        }

        /* LEVEL SELECT */
        #screen-select {
            padding-top: 12px;
        }

        .player-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            background: rgba(255, 255, 255, .06);
            border: 1px solid rgba(255, 255, 255, .08);
            border-radius: 14px;
            padding: 9px 16px;
        }

        .player-name-tag {
            color: #f5a623;
            font-weight: 700;
        }

        .btn-sm {
            background: rgba(255, 255, 255, .07);
            border: 1px solid rgba(255, 255, 255, .1);
            color: rgba(255, 255, 255, .5);
            border-radius: 50px;
            padding: 7px 16px;
            font-family: 'Kanit', sans-serif;
            font-size: .82rem;
            font-weight: 600;
            cursor: pointer;
            transition: all.2s;
        }

        .btn-sm:hover {
            background: rgba(255, 255, 255, .14);
            color: #fff;
        }

        .levels-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(148px, 1fr));
            gap: 11px;
            width: 100%;
        }

        .level-card {
            background: rgba(255, 255, 255, .07);
            border: 1px solid rgba(255, 255, 255, .09);
            border-radius: 16px;
            padding: 18px 12px;
            text-align: center;
            cursor: pointer;
            transition: all.22s;
            position: relative;
            overflow: hidden;
        }

        .level-card:hover:not(.locked) {
            transform: translateY(-4px);
            background: rgba(255, 255, 255, .13);
            box-shadow: 0 10px 30px rgba(0, 0, 0, .4);
        }

        .level-card.locked {
            opacity: .34;
            cursor: not-allowed;
        }

        .level-card.completed {
            border-color: rgba(72, 187, 120, .4);
        }

        .lv-num {
            position: absolute;
            top: 8px;
            right: 10px;
            font-size: .6rem;
            font-weight: 700;
            letter-spacing: 1px;
            color: rgba(255, 255, 255, .22);
        }

        .lv-icon {
            font-size: 1.9rem;
            margin-bottom: 4px;
        }

        .lv-name {
            font-size: .9rem;
            font-weight: 700;
            color: #fff;
            margin-bottom: 2px;
        }

        .lv-info {
            font-size: .7rem;
            color: rgba(255, 255, 255, .35);
        }

        .lv-stars {
            font-size: .85rem;
            margin-top: 6px;
            letter-spacing: 2px;
        }

        /* GAME */
        #screen-game {
            padding-top: 10px;
        }

        .game-head {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 8px;
        }

        .lv-head {
            display: flex;
            align-items: center;
            gap: 6px;
            background: rgba(255, 255, 255, .08);
            border: 1px solid rgba(255, 255, 255, .1);
            border-radius: 50px;
            padding: 6px 14px;
            color: #fff;
            font-weight: 700;
            font-size: .86rem;
        }

        .stats {
            display: flex;
            gap: 8px;
        }

        .sbox {
            background: rgba(255, 255, 255, .08);
            border: 1px solid rgba(255, 255, 255, .08);
            border-radius: 11px;
            padding: 5px 12px;
            text-align: center;
        }

        .sl {
            color: rgba(255, 255, 255, .28);
            font-size: .58rem;
            letter-spacing: .8px;
            text-transform: uppercase;
        }

        .sv {
            color: #fff;
            font-size: .98rem;
            font-weight: 700;
        }

        #tv {
            color: #f5a623;
        }

        #pv {
            color: #43e97b;
        }

        #mv {
            color: #f093fb;
        }

        .grid {
            display: grid;
            gap: 9px;
            width: 100%;
        }

        .grid.g4 {
            grid-template-columns: repeat(4, 1fr);
            max-width: 450px;
        }

        .grid.g5 {
            grid-template-columns: repeat(5, 1fr);
            max-width: 550px;
        }

        .card {
            aspect-ratio: 1;
            cursor: pointer;
            perspective: 600px;
            user-select: none;
        }

        .card-inner {
            width: 100%;
            height: 100%;
            position: relative;
            transform-style: preserve-3d;
            transition: transform .42s cubic-bezier(.4, 0, .2, 1);
            border-radius: 12px;
        }

        .card.flipped .card-inner,
        .card.matched .card-inner {
            transform: rotateY(180deg);
        }

        .card-back,
        .card-front {
            position: absolute;
            inset: 0;
            border-radius: 12px;
            backface-visibility: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .card-back {
            background: linear-gradient(135deg, #2d3748, #4a5568);
            border: 2px solid rgba(255, 255, 255, .1);
            font-size: 1.2rem;
            color: rgba(255, 255, 255, .2);
            box-shadow: 0 4px 14px rgba(0, 0, 0, .4);
        }

        .card:hover:not(.flipped):not(.matched) .card-back {
            background: linear-gradient(135deg, #3a4f6a, #587080);
        }

        .card-front {
            background: linear-gradient(135deg, #fff, #f0f4ff);
            transform: rotateY(180deg);
            border: 2px solid rgba(255, 255, 255, .8);
            box-shadow: 0 5px 18px rgba(0, 0, 0, .2);
            font-size: clamp(1.4rem, 3.5vw, 2rem);
        }

        .card.matched .card-front {
            background: linear-gradient(135deg, #c6f6d5, #9ae6b4);
            border-color: #48bb78;
            box-shadow: 0 0 16px rgba(72, 187, 120, .5);
            animation: mPop .4s ease;
        }

        @keyframes mPop {
            0% {
                transform: rotateY(180deg) scale(1)
            }

            50% {
                transform: rotateY(180deg) scale(1.14)
            }

            100% {
                transform: rotateY(180deg) scale(1)
            }
        }

        .card.wrong .card-inner {
            animation: shake .38s ease;
        }

        @keyframes shake {

            0%,
            100% {
                transform: rotateY(180deg) translateX(0)
            }

            25% {
                transform: rotateY(180deg) translateX(-6px)
            }

            75% {
                transform: rotateY(180deg) translateX(6px)
            }
        }

        .cbadge {
            position: absolute;
            top: -5px;
            right: -5px;
            z-index: 10;
            background: #e53e3e;
            color: #fff;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: .65rem;
            font-weight: 700;
        }

        /* WIN OVERLAY */
        #win-ov {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, .88);
            backdrop-filter: blur(8px);
            z-index: 300;
            align-items: center;
            justify-content: flex-start;
            padding: 12px;
            overflow-y: auto;
        }

        #win-ov.show {
            display: flex;
            flex-direction: column;
        }

        .win-card {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            border: 1px solid rgba(255, 255, 255, .13);
            border-radius: 24px;
            padding: 26px 28px;
            text-align: center;
            max-width: 480px;
            width: 100%;
            box-shadow: 0 28px 72px rgba(0, 0, 0, .6);
            animation: sUp .5s cubic-bezier(.34, 1.56, .64, 1);
            margin: auto;
        }

        @keyframes sUp {
            from {
                transform: translateY(60px) scale(.8);
                opacity: 0
            }

            to {
                transform: none;
                opacity: 1
            }
        }

        .we {
            font-size: 2.6rem;
            margin-bottom: 4px;
        }

        .wt {
            font-size: 1.6rem;
            font-weight: 800;
            background: linear-gradient(135deg, #f5a623, #f093fb, #43e97b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 3px;
        }

        .ws {
            color: rgba(255, 255, 255, .38);
            font-size: .86rem;
            margin-bottom: 14px;
        }

        .stars-row {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 14px;
        }

        .star {
            font-size: 2.2rem;
            opacity: 0;
            transform: scale(0) rotate(-30deg);
            animation: sPop .5s cubic-bezier(.34, 1.56, .64, 1) forwards;
        }

        .star.grey {
            filter: grayscale(1) brightness(.4);
        }

        .star:nth-child(1) {
            animation-delay: .2s
        }

        .star:nth-child(2) {
            animation-delay: .4s
        }

        .star:nth-child(3) {
            animation-delay: .6s
        }

        @keyframes sPop {
            to {
                opacity: 1;
                transform: scale(1) rotate(0)
            }
        }

        .win-meta {
            display: flex;
            gap: 12px;
            justify-content: center;
            margin-bottom: 12px;
            flex-wrap: wrap;
        }

        .wm-box {
            text-align: center;
        }

        .wm-l {
            color: rgba(255, 255, 255, .28);
            font-size: .6rem;
            letter-spacing: .8px;
            text-transform: uppercase;
        }

        .wm-v {
            color: #fff;
            font-size: 1.1rem;
            font-weight: 700;
        }

        .score100 {
            font-size: 1.9rem;
            font-weight: 900;
            background: linear-gradient(135deg, #f5a623, #fa709a);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 6px 0 3px;
        }

        /* WIN LB */
        .win-lb {
            margin-top: 16px;
            border-top: 1px solid rgba(255, 255, 255, .08);
            padding-top: 14px;
            text-align: left;
        }

        .win-lb-title {
            color: rgba(255, 255, 255, .35);
            font-size: .72rem;
            letter-spacing: 1px;
            text-transform: uppercase;
            margin-bottom: 10px;
            text-align: center;
        }

        .win-lb-podium {
            display: grid;
            grid-template-columns: 3fr 3fr 3fr;
            gap: 7px;
            margin-bottom: 10px;
        }

        .wlp-card {
            border-radius: 12px;
            padding: 12px 6px;
            text-align: center;
        }

        .wlp-card.gold {
            background: rgba(255, 215, 0, .18);
            border: 1px solid rgba(255, 215, 0, .35);
        }

        .wlp-card.silver {
            background: rgba(192, 192, 192, .13);
            border: 1px solid rgba(192, 192, 192, .22);
        }

        .wlp-card.bronze {
            background: rgba(205, 133, 63, .13);
            border: 1px solid rgba(205, 133, 63, .22);
        }

        .wlp-rank {
            font-size: 1.3rem;
            margin-bottom: 3px;
        }

        .wlp-name {
            color: #fff;
            font-weight: 700;
            font-size: .76rem;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .wlp-time {
            font-weight: 800;
            font-size: .95rem;
            margin-top: 2px;
        }

        .wlp-card.gold .wlp-time {
            color: #f5a623;
        }

        .wlp-card.silver .wlp-time {
            color: #c0c0c0;
        }

        .wlp-card.bronze .wlp-time {
            color: #cd853f;
        }

        .wlp-me {
            outline: 2px solid rgba(240, 147, 251, .5);
        }

        .win-lb-rest-row {
            display: grid;
            grid-template-columns: 28px 1fr 65px;
            gap: 6px;
            align-items: center;
            padding: 7px 10px;
            border-radius: 9px;
            margin-bottom: 4px;
            background: rgba(255, 255, 255, .04);
            border: 1px solid rgba(255, 255, 255, .05);
        }

        .win-lb-rest-row.is-me {
            background: rgba(240, 147, 251, .08);
            border-color: rgba(240, 147, 251, .25);
        }

        .wlrr-rk {
            color: rgba(255, 255, 255, .38);
            font-size: .78rem;
            font-weight: 700;
            text-align: center;
        }

        .wlrr-nm {
            color: #fff;
            font-weight: 600;
            font-size: .8rem;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .wlrr-tm {
            color: #43e97b;
            font-weight: 700;
            font-size: .8rem;
            text-align: right;
        }

        .btns-row {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            justify-content: center;
            margin-top: 16px;
        }

        .btn-n {
            padding: 11px 24px;
            border: none;
            border-radius: 50px;
            font-family: 'Kanit', sans-serif;
            font-size: .9rem;
            font-weight: 700;
            cursor: pointer;
            transition: all.2s;
        }

        .btn-next {
            background: linear-gradient(135deg, #43e97b, #38f9d7);
            color: #0f3460;
            box-shadow: 0 6px 16px rgba(67, 233, 123, .35);
        }

        .btn-next:hover {
            transform: translateY(-2px);
        }

        .btn-replay {
            background: linear-gradient(135deg, #f093fb, #f5a623);
            color: #fff;
            box-shadow: 0 6px 16px rgba(240, 147, 251, .35);
        }

        .btn-replay:hover {
            transform: translateY(-2px);
        }

        canvas#fw {
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: 299;
        }

        @media(max-width:400px) {
            .grid.g4 {
                max-width: 320px;
                gap: 7px;
            }

            .grid.g5 {
                grid-template-columns: repeat(4, 1fr);
                max-width: 340px;
            }

            .podium-row {
                grid-template-columns: 1fr 1fr 1fr;
            }

            .win-card {
                padding: 20px 16px;
            }
        }
    </style>
</head>

<body>
    <canvas id="fw"></canvas>

    <!-- ‚ïê‚ïê LOGIN ‚ïê‚ïê -->
    <div class="screen active" id="screen-login">
        <div style="text-align:center;padding-top:24px;">
            <span class="logo-emoji">üéÆ</span>
            <div class="logo-main">‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡πÅ‡∏™‡∏ô‡∏™‡∏ô‡∏∏‡∏Å</div>
            <div class="logo-sub">Memory Match ¬∑ 5 ‡∏î‡πà‡∏≤‡∏ô</div>
        </div>
        <div class="login-card">
            <label class="login-label">‚úèÔ∏è ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏•‡πà‡∏ô</label>
            <input id="name-input" class="name-input" type="text" placeholder="‡∏ä‡∏∑‡πà‡∏≠ / Nickname" maxlength="24"
                autocomplete="off">
            <button id="btn-enter" class="btn-start" onclick="enterGame()" disabled>‚ñ∂ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏•‡∏¢!</button>
        </div>
        <div class="lb-wrap">
            <div class="lb-section-title">üèÜ ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô ‚Äî ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤‡∏ô‡πâ‡∏≠‡∏¢‡∏™‡∏∏‡∏î</div>
            <div id="lb-login"></div>
        </div>
    </div>

    <!-- ‚ïê‚ïê LEVEL SELECT ‚ïê‚ïê -->
    <div class="screen" id="screen-select">
        <div style="text-align:center;">
            <div class="logo-main" style="font-size:clamp(1.5rem,4vw,2.2rem);">‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡πÅ‡∏™‡∏ô‡∏™‡∏ô‡∏∏‡∏Å</div>
        </div>
        <div class="player-bar">
            <div>üë§ <span id="player-tag" style="color:#f5a623;font-weight:700;"></span></div>
            <button class="btn-sm" onclick="logout()">‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠</button>
        </div>
        <div class="levels-grid" id="levels-grid"></div>
        <button class="btn-sm" onclick="goLBScreen()">üèÜ ‡∏î‡∏π‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
    </div>

    <!-- ‚ïê‚ïê GAME ‚ïê‚ïê -->
    <div class="screen" id="screen-game">
        <div class="game-head">
            <div style="display:flex;gap:8px;align-items:center;">
                <button class="btn-sm" onclick="goSelect()">‚Üê ‡πÄ‡∏°‡∏ô‡∏π</button>
                <div class="lv-head" id="lv-head">‡∏î‡πà‡∏≤‡∏ô 1</div>
            </div>
            <div class="stats">
                <div class="sbox">
                    <div class="sl">‚è±</div>
                    <div class="sv" id="tv">0:00</div>
                </div>
                <div class="sbox">
                    <div class="sl">‡∏Ñ‡∏π‡πà</div>
                    <div class="sv" id="pv">0/0</div>
                </div>
                <div class="sbox">
                    <div class="sl">‡∏Ñ‡∏£‡∏±‡πâ‡∏á</div>
                    <div class="sv" id="mv">0</div>
                </div>
            </div>
        </div>
        <div class="grid g4" id="grid"></div>
    </div>

    <!-- ‚ïê‚ïê LEADERBOARD SCREEN ‚ïê‚ïê -->
    <div class="screen" id="screen-lb">
        <div style="text-align:center;">
            <div class="logo-main" style="font-size:clamp(1.4rem,4vw,2.1rem);">üèÜ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô</div>
            <div class="logo-sub">‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏Ñ‡∏£‡∏ö 5 ‡∏î‡πà‡∏≤‡∏ô ¬∑ ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏£‡πá‡∏ß‡∏™‡∏∏‡∏î</div>
        </div>
        <div class="lb-wrap" style="max-width:480px;">
            <div id="lb-full"></div>
        </div>
        <button class="btn-sm" onclick="goSelect()">‚Üê ‡∏Å‡∏•‡∏±‡∏ö</button>
    </div>

    <!-- ‚ïê‚ïê WIN OVERLAY ‚ïê‚ïê -->
    <div id="win-ov">
        <div class="win-card">
            <div class="we" id="we">üèÖ</div>
            <div class="wt" id="wt">‡∏ú‡πà‡∏≤‡∏ô‡∏î‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß!</div>
            <div class="ws" id="ws"></div>
            <div class="stars-row" id="stars-row"></div>
            <div id="perfect-wrap" style="display:none;">
                <div class="score100">üéä 100 ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô!</div>
                <div style="color:rgba(255,255,255,.35);font-size:.8rem;margin-bottom:6px;">‡∏ú‡πà‡∏≤‡∏ô‡∏Ñ‡∏£‡∏ö‡∏ó‡∏±‡πâ‡∏á 5 ‡∏î‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß!
                </div>
            </div>
            <div class="win-meta">
                <div class="wm-box">
                    <div class="wm-l">‡πÄ‡∏ß‡∏•‡∏≤‡∏î‡πà‡∏≤‡∏ô‡∏ô‡∏µ‡πâ</div>
                    <div class="wm-v" id="wm-time">-</div>
                </div>
                <div class="wm-box" id="wm-total-box" style="display:none;">
                    <div class="wm-l">‡πÄ‡∏ß‡∏•‡∏≤‡∏£‡∏ß‡∏° 5 ‡∏î‡πà‡∏≤‡∏ô</div>
                    <div class="wm-v" id="wm-total" style="color:#f5a623;">-</div>
                </div>
                <div class="wm-box">
                    <div class="wm-l">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á</div>
                    <div class="wm-v" id="wm-moves">-</div>
                </div>
            </div>
            <!-- Leaderboard inside win card (only shown when all 5 done) -->
            <div class="win-lb" id="win-lb" style="display:none;">
                <div class="win-lb-title">üìä ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                <div id="win-lb-podium" class="win-lb-podium"></div>
                <div id="win-lb-rest"></div>
            </div>
            <div class="btns-row" id="win-btns"></div>
        </div>
    </div>

    <script>
        // ‚ïê‚ïê LEVELS ‚ïê‚ïê
        const LEVELS = [
            { id: 1, name: '‡∏ú‡∏•‡πÑ‡∏°‡πâ‡∏™‡∏î', icon: 'üçì', cols: 4, desc: '6 ‡∏Ñ‡∏π‡πà ‚Ä¢ ‡∏ú‡∏•‡πÑ‡∏°‡πâ', items: ['üçì', 'üçá', 'üçä', 'üçé', 'üçå', 'ü••'] },
            { id: 2, name: '‡∏ú‡∏•‡πÑ‡∏°‡πâ‡∏´‡∏ß‡∏≤‡∏ô', icon: 'üçí', cols: 4, desc: '6 ‡∏Ñ‡∏π‡πà ‚Ä¢ ‡∏ú‡∏•‡πÑ‡∏°‡πâ', items: ['üçí', 'üçç', 'üçâ', 'ü•≠', 'üçê', 'ü•ù'] },
            { id: 3, name: '‡πÇ‡∏•‡∏Å‡∏™‡∏±‡∏ï‡∏ß‡πå', icon: 'üêØ', cols: 4, desc: '8 ‡∏Ñ‡∏π‡πà ‚Ä¢ ‡∏™‡∏±‡∏ï‡∏ß‡πå', items: ['üêÑ', 'üêØ', 'üêä', 'üêï', 'üê±', 'ü¶ú', 'ü¶≠', 'ü¶ê'] },
            { id: 4, name: '‡∏°‡∏¥‡∏Å‡∏ã‡πå‡∏™‡∏∏‡∏î‡∏°‡∏±‡∏ô', icon: 'ü¶Å', cols: 5, desc: '10 ‡∏Ñ‡∏π‡πà ‚Ä¢ ‡∏ú‡∏•‡πÑ‡∏°‡πâ+‡∏™‡∏±‡∏ï‡∏ß‡πå', items: ['üçì', 'üçä', 'ü••', 'ü•≠', 'üçé', 'üê±', 'ü¶Å', 'üê¨', 'üêÉ', 'ü¶Ä'] },
            { id: 5, name: '‡∏ú‡∏±‡∏Å‡∏™‡∏î‡πÉ‡∏™', icon: 'ü•ï', cols: 4, desc: '8 ‡∏Ñ‡∏π‡πà ‚Ä¢ ‡∏ú‡∏±‡∏Å', items: ['ü•í', 'ü•¨', 'ü•ï', 'ü•¶', 'üåø', 'üçÖ', 'üçÜ', 'üçÉ'] }
        ];
        const FLIP_BACK = 1000;
        function getStars(id, s) { return id <= 2 ? (s <= 50 ? 3 : s <= 60 ? 2 : 1) : (s <= 70 ? 3 : s <= 90 ? 2 : 1); }
        function fmtT(s) { return `${Math.floor(s / 60)}:${String(s % 60).padStart(2, '0')}`; }
        function shuffle(a) { const b = [...a]; for (let i = b.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1));[b[i], b[j]] = [b[j], b[i]]; } return b; }
        function showScreen(id) { document.querySelectorAll('.screen').forEach(s => s.classList.remove('active')); document.getElementById(id).classList.add('active'); }

        // ‚ïê‚ïê STATE ‚ïê‚ïê
        let playerName = '', completedLevels = new Set(), levelStars = {}, sessionTimes = {};
        let currentLevel = null, flipped = [], matched = 0, moves = 0, totalPairs = 0;
        let canFlip = true, timerInt = null, seconds = 0;
        let particles = [], fwInt = null;

        function loadLocal() {
            completedLevels = new Set(JSON.parse(localStorage.getItem('mm_done') || '[]'));
            levelStars = JSON.parse(localStorage.getItem('mm_stars') || '{}');
            playerName = localStorage.getItem('mm_player') || '';
        }
        function saveLocal() {
            localStorage.setItem('mm_done', JSON.stringify([...completedLevels]));
            localStorage.setItem('mm_stars', JSON.stringify(levelStars));
            localStorage.setItem('mm_player', playerName);
        }

        // ‚ïê‚ïê LEADERBOARD (localStorage, cumulative) ‚ïê‚ïê
        function getLB() { return JSON.parse(localStorage.getItem('mm_leaderboard') || '[]'); }
        function saveLB(lb) { localStorage.setItem('mm_leaderboard', JSON.stringify(lb.slice(0, 200))); }
        function addToLB(entry) {
            const lb = getLB();
            lb.push(entry);
            lb.sort((a, b) => a.total - b.total);
            saveLB(lb);
            return lb;
        }

        // ‚ïê‚ïê RENDER LB ‚ïê‚ïê
        function renderLBSection(lb, containerId, myName = '', maxRows = 999) {
            const el = document.getElementById(containerId);
            if (!lb || lb.length === 0) { el.innerHTML = '<div class="lb-empty">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô‡∏Ñ‡∏£‡∏ö 5 ‡∏î‡πà‡∏≤‡∏ô<br>üåü ‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏ô‡πÅ‡∏£‡∏Å!</div>'; return; }

            const top3 = lb.slice(0, 3);
            const rest = lb.slice(3, maxRows);
            const classes = ['gold', 'silver', 'bronze'];
            const medals = ['ü•á', 'ü•à', 'ü•â'];

            // Podium
            let podiumHTML = `<div class="podium-row">`;
            top3.forEach((r, i) => {
                const me = r.name === myName;
                podiumHTML += `<div class="podium-card ${classes[i]}${me ? ' wlp-me' : ''}">
            <div class="podium-rank">${medals[i]}</div>
            <div class="podium-name" title="${r.name}">${r.name}${me ? ' üëà' : ''}</div>
            <div class="podium-time">${fmtT(r.total)}</div>
            <div class="podium-stars">${'‚≠ê'.repeat(r.stars || 0)}</div>
        </div>`;
            });
            podiumHTML += '</div>';

            // Rest rows
            let restHTML = '';
            rest.forEach((r, i) => {
                const rank = i + 4;
                const me = r.name === myName;
                restHTML += `<div class="lb-list-row${me ? ' is-me' : ''}">
            <span class="lb-rk">${rank}</span>
            <span class="lb-nm" title="${r.name}">${r.name}${me ? ' üëà' : ''}</span>
            <span class="lb-tm">${fmtT(r.total)}</span>
            <span class="lb-st">${'‚≠ê'.repeat(Math.min(r.stars || 0, 5))}</span>
        </div>`;
            });

            el.innerHTML = podiumHTML + restHTML;
        }

        function renderWinLB(lb, myName) {
            if (!lb || lb.length === 0) return;
            const top3 = lb.slice(0, 3);
            const rest = lb.slice(3);
            const classes = ['gold', 'silver', 'bronze'];
            const medals = ['ü•á', 'ü•à', 'ü•â'];

            let pHTML = '';
            top3.forEach((r, i) => {
                const me = r.name === myName;
                pHTML += `<div class="wlp-card ${classes[i]}${me ? ' wlp-me' : ''}">
            <div class="wlp-rank">${medals[i]}</div>
            <div class="wlp-name" title="${r.name}">${r.name}${me ? ' üëà' : ''}</div>
            <div class="wlp-time">${fmtT(r.total)}</div>
        </div>`;
            });
            document.getElementById('win-lb-podium').innerHTML = pHTML;

            let rHTML = '';
            rest.forEach((r, i) => {
                const me = r.name === myName;
                rHTML += `<div class="win-lb-rest-row${me ? ' is-me' : ''}">
            <span class="wlrr-rk">${i + 4}</span>
            <span class="wlrr-nm">${r.name}${me ? ' üëà' : ''}</span>
            <span class="wlrr-tm">${fmtT(r.total)}</span>
        </div>`;
            });
            document.getElementById('win-lb-rest').innerHTML = rHTML;
        }

        // ‚ïê‚ïê INIT ‚ïê‚ïê
        loadLocal();
        const nameInput = document.getElementById('name-input');
        const btnEnter = document.getElementById('btn-enter');
        nameInput.addEventListener('input', () => { btnEnter.disabled = nameInput.value.trim().length < 2; });
        nameInput.addEventListener('keydown', e => { if (e.key === 'Enter' && !btnEnter.disabled) enterGame(); });
        if (playerName) { nameInput.value = playerName; btnEnter.disabled = false; }
        renderLBSection(getLB(), 'lb-login');

        function enterGame() {
            const n = nameInput.value.trim();
            if (n.length < 2) return;
            playerName = n; sessionTimes = {}; saveLocal();
            renderSelect(); showScreen('screen-select');
        }
        function logout() { showScreen('screen-login'); renderLBSection(getLB(), 'lb-login'); }
        function goLBScreen() { renderLBSection(getLB(), 'lb-full', playerName); showScreen('screen-lb'); }

        // ‚ïê‚ïê LEVEL SELECT ‚ïê‚ïê
        function renderSelect() {
            document.getElementById('player-tag').textContent = playerName;
            const grid = document.getElementById('levels-grid'); grid.innerHTML = '';
            const maxDone = completedLevels.size > 0 ? Math.max(...completedLevels) : 0;
            LEVELS.forEach(lv => {
                const done = completedLevels.has(lv.id);
                const locked = lv.id > maxDone + 1;
                const stars = levelStars[lv.id] || 0;
                const div = document.createElement('div');
                div.className = 'level-card' + (done ? ' completed' : '') + (locked ? ' locked' : '');
                div.innerHTML = `<div class="lv-num">LV ${lv.id}</div>
            <div class="lv-icon">${lv.icon}</div>
            <div class="lv-name">${lv.name}</div>
            <div class="lv-info">${lv.desc}</div>
            <div class="lv-stars" style="${done ? 'color:#43e97b' : 'color:#fbd38d'}">${locked ? 'üîí' : done ? '‚òÖ'.repeat(stars) + '‚òÜ'.repeat(3 - stars) : '‚òÜ‚òÜ‚òÜ'}</div>`;
                if (!locked) div.onclick = () => startLevel(lv);
                grid.appendChild(div);
            });
        }
        function goSelect() { stopTimer(); renderSelect(); showScreen('screen-select'); }

        // ‚ïê‚ïê GAME ‚ïê‚ïê
        function startLevel(lv) {
            currentLevel = lv; flipped = []; matched = 0; moves = 0; canFlip = true; seconds = 0; totalPairs = lv.items.length; stopTimer();
            document.getElementById('win-ov').classList.remove('show');
            document.getElementById('lv-head').textContent = `‡∏î‡πà‡∏≤‡∏ô ${lv.id} ‚Äì ${lv.name}`;
            document.getElementById('pv').textContent = `0/${totalPairs}`;
            document.getElementById('mv').textContent = '0'; document.getElementById('tv').textContent = '0:00';
            const grid = document.getElementById('grid');
            grid.className = 'grid ' + (lv.cols === 5 ? 'g5' : 'g4');
            shuffle([...lv.items, ...lv.items]).forEach((emoji, idx) => {
                const c = document.createElement('div'); c.className = 'card'; c.dataset.emoji = emoji; c.dataset.idx = idx;
                c.innerHTML = `<div class="card-inner"><div class="card-back">?</div><div class="card-front">${emoji}</div></div>`;
                c.addEventListener('click', () => onFlip(c)); grid.appendChild(c);
            });
            showScreen('screen-game'); startTimer();
        }
        function onFlip(card) {
            if (!canFlip || card.classList.contains('flipped') || card.classList.contains('matched') || flipped.length >= 2) return;
            card.classList.add('flipped'); flipped.push(card);
            if (flipped.length === 2) { moves++; document.getElementById('mv').textContent = moves; canFlip = false; checkPair(); }
        }
        function checkPair() {
            const [a, b] = flipped;
            if (a.dataset.emoji === b.dataset.emoji) {
                setTimeout(() => {
                    a.classList.add('matched'); b.classList.add('matched'); matched++;
                    document.getElementById('pv').textContent = `${matched}/${totalPairs}`;
                    flipped = []; canFlip = true; if (matched === totalPairs) onWin();
                }, 350);
            } else {
                a.classList.add('wrong'); b.classList.add('wrong'); addBadge(a); addBadge(b);
                setTimeout(() => { removeBadge(a); removeBadge(b); a.classList.remove('flipped', 'wrong'); b.classList.remove('flipped', 'wrong'); flipped = []; canFlip = true; }, FLIP_BACK);
            }
        }
        function addBadge(c) { removeBadge(c); const b = document.createElement('div'); b.className = 'cbadge'; b.textContent = '1'; c.style.position = 'relative'; c.appendChild(b); }
        function removeBadge(c) { const b = c.querySelector('.cbadge'); if (b) b.remove(); }
        function startTimer() { timerInt = setInterval(() => { seconds++; document.getElementById('tv').textContent = fmtT(seconds); }, 1000); }
        function stopTimer() { clearInterval(timerInt); timerInt = null; }

        // ‚ïê‚ïê WIN ‚ïê‚ïê
        function onWin() {
            stopTimer();
            sessionTimes[currentLevel.id] = seconds;
            const earned = getStars(currentLevel.id, seconds);
            if (!levelStars[currentLevel.id] || earned > levelStars[currentLevel.id]) levelStars[currentLevel.id] = earned;
            for (let i = 1; i <= currentLevel.id; i++)completedLevels.add(i);
            saveLocal();

            const totalSecs = Object.values(sessionTimes).reduce((a, b) => a + b, 0);
            const allDone = currentLevel.id === 5 && Object.keys(sessionTimes).length === 5;

            // Stars
            const starsRow = document.getElementById('stars-row'); starsRow.innerHTML = '';
            for (let i = 1; i <= 3; i++) { const s = document.createElement('span'); s.className = 'star' + (i > earned ? ' grey' : ''); s.textContent = '‚≠ê'; starsRow.appendChild(s); }

            document.getElementById('we').textContent = allDone ? 'ü•á' : (earned === 3 ? 'üèÜ' : earned === 2 ? 'ü•à' : 'ü•â');
            document.getElementById('wt').textContent = allDone ? 'üéä ‡∏ú‡πà‡∏≤‡∏ô‡∏Ñ‡∏£‡∏ö‡πÅ‡∏•‡πâ‡∏ß!' : (earned === 3 ? '‡∏¢‡∏≠‡∏î‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°!' : earned === 2 ? '‡πÄ‡∏Å‡πà‡∏á‡∏°‡∏≤‡∏Å!' : '‡∏ú‡πà‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß!');
            document.getElementById('ws').textContent = allDone ? `${playerName} ‡∏ú‡πà‡∏≤‡∏ô‡∏Ñ‡∏£‡∏ö 5 ‡∏î‡πà‡∏≤‡∏ô!` : `‡∏î‡πà‡∏≤‡∏ô ${currentLevel.id} ‚Äì ${currentLevel.name}`;
            document.getElementById('wm-time').textContent = fmtT(seconds);
            document.getElementById('wm-moves').textContent = `${moves} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á`;
            document.getElementById('perfect-wrap').style.display = allDone ? 'block' : 'none';

            const totalBox = document.getElementById('wm-total-box');
            if (allDone) { totalBox.style.display = 'block'; document.getElementById('wm-total').textContent = fmtT(totalSecs); }
            else { totalBox.style.display = 'none'; }

            // Save + show LB when all done
            let updatedLB = [];
            if (allDone) {
                const totalStars = Object.values(levelStars).reduce((a, b) => a + b, 0);
                updatedLB = addToLB({ name: playerName, total: totalSecs, stars: totalStars, date: new Date().toLocaleDateString('th-TH') });
                document.getElementById('win-lb').style.display = 'block';
                renderWinLB(updatedLB, playerName);
            } else {
                document.getElementById('win-lb').style.display = 'none';
            }

            // Buttons
            const btnDiv = document.getElementById('win-btns'); btnDiv.innerHTML = '';
            const nextLv = LEVELS.find(lv => lv.id === currentLevel.id + 1);
            if (nextLv) {
                const nb = document.createElement('button'); nb.className = 'btn-n btn-next'; nb.textContent = `‚ñ∂ ‡∏î‡πà‡∏≤‡∏ô ${nextLv.id}`;
                nb.onclick = () => { document.getElementById('win-ov').classList.remove('show'); startLevel(nextLv); }; btnDiv.appendChild(nb);
            }
            const rb = document.createElement('button'); rb.className = 'btn-n btn-replay';
            rb.textContent = allDone ? 'üè† ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å' : 'üîÑ ‡πÄ‡∏•‡πà‡∏ô‡∏î‡πà‡∏≤‡∏ô‡∏ô‡∏µ‡πâ‡∏≠‡∏µ‡∏Å';
            rb.onclick = () => { document.getElementById('win-ov').classList.remove('show'); allDone ? (renderSelect(), showScreen('screen-select')) : startLevel(currentLevel); };
            btnDiv.appendChild(rb);

            setTimeout(() => { document.getElementById('win-ov').classList.add('show'); launchFireworks(allDone ? 22 : 8); }, 500);
        }

        // ‚ïê‚ïê FIREWORKS ‚ïê‚ïê
        const fwc = document.getElementById('fw'), fwx = fwc.getContext('2d');
        function rFW() { fwc.width = innerWidth; fwc.height = innerHeight; } rFW(); window.addEventListener('resize', rFW);
        const FWCOLS = ['#f093fb', '#f5a623', '#43e97b', '#4facfe', '#fa709a', '#fee140', '#a18cd1', '#43c6ac'];
        function rC() { return FWCOLS[Math.floor(Math.random() * FWCOLS.length)]; }
        function burst(x, y, n = 55) { for (let i = 0; i < n; i++) { const a = (Math.PI * 2 / n) * i, sp = 1.8 + Math.random() * 5; particles.push({ x, y, vx: Math.cos(a) * sp, vy: Math.sin(a) * sp, alpha: 1, color: rC(), size: 1.8 + Math.random() * 3, g: .09 }); } }
        function animFW() { fwx.clearRect(0, 0, fwc.width, fwc.height); particles.forEach(p => { p.x += p.vx; p.y += p.vy; p.vy += p.g; p.alpha -= .015; fwx.beginPath(); fwx.arc(p.x, p.y, p.size, 0, Math.PI * 2); fwx.fillStyle = p.color + Math.floor(p.alpha * 255).toString(16).padStart(2, '0'); fwx.fill(); }); particles = particles.filter(p => p.alpha > 0); if (particles.length > 0 || fwInt) requestAnimationFrame(animFW); }
        function launchFireworks(count = 10) { particles = []; let n = 0; fwInt = setInterval(() => { burst(80 + Math.random() * (innerWidth - 160), 60 + Math.random() * (innerHeight * .52), 62); n++; if (n >= count) { clearInterval(fwInt); fwInt = null; } }, 280); requestAnimationFrame(animFW); }
    </script>
</body>

</html>